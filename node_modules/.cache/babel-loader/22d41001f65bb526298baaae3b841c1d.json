{"ast":null,"code":"/**\n * @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module image/imageresize/imageresizeediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core';\nimport ImageUtils from '../imageutils';\nimport ResizeImageCommand from './resizeimagecommand';\n\n/**\n * The image resize editing feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class ImageResizeEditing extends Plugin {\n  /**\n   * @inheritDoc\n   */\n  static get requires() {\n    return [ImageUtils];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  static get pluginName() {\n    return 'ImageResizeEditing';\n  }\n\n  /**\n   * @inheritDoc\n   */\n  constructor(editor) {\n    super(editor);\n    editor.config.define('image', {\n      resizeUnit: '%',\n      resizeOptions: [{\n        name: 'resizeImage:original',\n        value: null,\n        icon: 'original'\n      }, {\n        name: 'resizeImage:25',\n        value: '25',\n        icon: 'small'\n      }, {\n        name: 'resizeImage:50',\n        value: '50',\n        icon: 'medium'\n      }, {\n        name: 'resizeImage:75',\n        value: '75',\n        icon: 'large'\n      }]\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  init() {\n    const editor = this.editor;\n    const resizeImageCommand = new ResizeImageCommand(editor);\n    this._registerSchema();\n    this._registerConverters('imageBlock');\n    this._registerConverters('imageInline');\n\n    // Register `resizeImage` command and add `imageResize` command as an alias for backward compatibility.\n    editor.commands.add('resizeImage', resizeImageCommand);\n    editor.commands.add('imageResize', resizeImageCommand);\n  }\n\n  /**\n   * @private\n   */\n  _registerSchema() {\n    if (this.editor.plugins.has('ImageBlockEditing')) {\n      this.editor.model.schema.extend('imageBlock', {\n        allowAttributes: 'width'\n      });\n    }\n    if (this.editor.plugins.has('ImageInlineEditing')) {\n      this.editor.model.schema.extend('imageInline', {\n        allowAttributes: 'width'\n      });\n    }\n  }\n\n  /**\n   * Registers image resize converters.\n   *\n   * @private\n   * @param {'imageBlock'|'imageInline'} imageType The type of the image.\n   */\n  _registerConverters(imageType) {\n    const editor = this.editor;\n\n    // Dedicated converter to propagate image's attribute to the img tag.\n    editor.conversion.for('downcast').add(dispatcher => dispatcher.on(`attribute:width:${imageType}`, (evt, data, conversionApi) => {\n      if (!conversionApi.consumable.consume(data.item, evt.name)) {\n        return;\n      }\n      const viewWriter = conversionApi.writer;\n      const figure = conversionApi.mapper.toViewElement(data.item);\n      if (data.attributeNewValue !== null) {\n        viewWriter.setStyle('width', data.attributeNewValue, figure);\n        viewWriter.addClass('image_resized', figure);\n      } else {\n        viewWriter.removeStyle('width', figure);\n        viewWriter.removeClass('image_resized', figure);\n      }\n    }));\n    editor.conversion.for('upcast').attributeToAttribute({\n      view: {\n        name: imageType === 'imageBlock' ? 'figure' : 'img',\n        styles: {\n          width: /.+/\n        }\n      },\n      model: {\n        key: 'width',\n        value: viewElement => viewElement.getStyle('width')\n      }\n    });\n  }\n}","map":{"version":3,"names":["Plugin","ImageUtils","ResizeImageCommand","ImageResizeEditing","requires","pluginName","constructor","editor","config","define","resizeUnit","resizeOptions","name","value","icon","init","resizeImageCommand","_registerSchema","_registerConverters","commands","add","plugins","has","model","schema","extend","allowAttributes","imageType","conversion","for","dispatcher","on","evt","data","conversionApi","consumable","consume","item","viewWriter","writer","figure","mapper","toViewElement","attributeNewValue","setStyle","addClass","removeStyle","removeClass","attributeToAttribute","view","styles","width","key","viewElement","getStyle"],"sources":["C:/data/project/realproject/node_modules/@ckeditor/ckeditor5-image/src/imageresize/imageresizeediting.js"],"sourcesContent":["/**\n * @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\n/**\n * @module image/imageresize/imageresizeediting\n */\n\nimport { Plugin } from 'ckeditor5/src/core';\nimport ImageUtils from '../imageutils';\nimport ResizeImageCommand from './resizeimagecommand';\n\n/**\n * The image resize editing feature.\n *\n * It adds the ability to resize each image using handles or manually by\n * {@link module:image/imageresize/imageresizebuttons~ImageResizeButtons} buttons.\n *\n * @extends module:core/plugin~Plugin\n */\nexport default class ImageResizeEditing extends Plugin {\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get requires() {\n\t\treturn [ ImageUtils ];\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tstatic get pluginName() {\n\t\treturn 'ImageResizeEditing';\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tconstructor( editor ) {\n\t\tsuper( editor );\n\n\t\teditor.config.define( 'image', {\n\t\t\tresizeUnit: '%',\n\t\t\tresizeOptions: [ {\n\t\t\t\tname: 'resizeImage:original',\n\t\t\t\tvalue: null,\n\t\t\t\ticon: 'original'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'resizeImage:25',\n\t\t\t\tvalue: '25',\n\t\t\t\ticon: 'small'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'resizeImage:50',\n\t\t\t\tvalue: '50',\n\t\t\t\ticon: 'medium'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'resizeImage:75',\n\t\t\t\tvalue: '75',\n\t\t\t\ticon: 'large'\n\t\t\t} ]\n\t\t} );\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tinit() {\n\t\tconst editor = this.editor;\n\t\tconst resizeImageCommand = new ResizeImageCommand( editor );\n\n\t\tthis._registerSchema();\n\t\tthis._registerConverters( 'imageBlock' );\n\t\tthis._registerConverters( 'imageInline' );\n\n\t\t// Register `resizeImage` command and add `imageResize` command as an alias for backward compatibility.\n\t\teditor.commands.add( 'resizeImage', resizeImageCommand );\n\t\teditor.commands.add( 'imageResize', resizeImageCommand );\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_registerSchema() {\n\t\tif ( this.editor.plugins.has( 'ImageBlockEditing' ) ) {\n\t\t\tthis.editor.model.schema.extend( 'imageBlock', { allowAttributes: 'width' } );\n\t\t}\n\n\t\tif ( this.editor.plugins.has( 'ImageInlineEditing' ) ) {\n\t\t\tthis.editor.model.schema.extend( 'imageInline', { allowAttributes: 'width' } );\n\t\t}\n\t}\n\n\t/**\n\t * Registers image resize converters.\n\t *\n\t * @private\n\t * @param {'imageBlock'|'imageInline'} imageType The type of the image.\n\t */\n\t_registerConverters( imageType ) {\n\t\tconst editor = this.editor;\n\n\t\t// Dedicated converter to propagate image's attribute to the img tag.\n\t\teditor.conversion.for( 'downcast' ).add( dispatcher =>\n\t\t\tdispatcher.on( `attribute:width:${ imageType }`, ( evt, data, conversionApi ) => {\n\t\t\t\tif ( !conversionApi.consumable.consume( data.item, evt.name ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst viewWriter = conversionApi.writer;\n\t\t\t\tconst figure = conversionApi.mapper.toViewElement( data.item );\n\n\t\t\t\tif ( data.attributeNewValue !== null ) {\n\t\t\t\t\tviewWriter.setStyle( 'width', data.attributeNewValue, figure );\n\t\t\t\t\tviewWriter.addClass( 'image_resized', figure );\n\t\t\t\t} else {\n\t\t\t\t\tviewWriter.removeStyle( 'width', figure );\n\t\t\t\t\tviewWriter.removeClass( 'image_resized', figure );\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\n\t\teditor.conversion.for( 'upcast' )\n\t\t\t.attributeToAttribute( {\n\t\t\t\tview: {\n\t\t\t\t\tname: imageType === 'imageBlock' ? 'figure' : 'img',\n\t\t\t\t\tstyles: {\n\t\t\t\t\t\twidth: /.+/\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmodel: {\n\t\t\t\t\tkey: 'width',\n\t\t\t\t\tvalue: viewElement => viewElement.getStyle( 'width' )\n\t\t\t\t}\n\t\t\t} );\n\t}\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}