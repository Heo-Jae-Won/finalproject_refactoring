{"ast":null,"code":"/**\n * @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\nimport { isFunction } from 'lodash-es';\nimport CKEditorError from '@ckeditor/ckeditor5-utils/src/ckeditorerror';\n\n/**\n * @module core/editor/utils/attachtoform\n */\n\n/**\n * Checks if the editor is initialized on a `<textarea>` element that belongs to a form. If yes, it updates the editor's element\n * content before submitting the form.\n *\n * This helper requires the {@link module:core/editor/utils/elementapimixin~ElementApi ElementApi interface}.\n *\n * @param {module:core/editor/editor~Editor} editor Editor instance.\n */\nexport default function attachToForm(editor) {\n  if (!isFunction(editor.updateSourceElement)) {\n    /**\n     * The editor passed to `attachToForm()` must implement the\n     * {@link module:core/editor/utils/elementapimixin~ElementApi} interface.\n     *\n     * @error attachtoform-missing-elementapi-interface\n     */\n    throw new CKEditorError('attachtoform-missing-elementapi-interface', editor);\n  }\n  const sourceElement = editor.sourceElement;\n\n  // Only when replacing a textarea which is inside of a form element.\n  if (sourceElement && sourceElement.tagName.toLowerCase() === 'textarea' && sourceElement.form) {\n    let originalSubmit;\n    const form = sourceElement.form;\n    const onSubmit = () => editor.updateSourceElement();\n\n    // Replace the original form#submit() to call a custom submit function first.\n    // Check if #submit is a function because the form might have an input named \"submit\".\n    if (isFunction(form.submit)) {\n      originalSubmit = form.submit;\n      form.submit = () => {\n        onSubmit();\n        originalSubmit.apply(form);\n      };\n    }\n\n    // Update the replaced textarea with data before each form#submit event.\n    form.addEventListener('submit', onSubmit);\n\n    // Remove the submit listener and revert the original submit method on\n    // editor#destroy.\n    editor.on('destroy', () => {\n      form.removeEventListener('submit', onSubmit);\n      if (originalSubmit) {\n        form.submit = originalSubmit;\n      }\n    });\n  }\n}","map":{"version":3,"names":["isFunction","CKEditorError","attachToForm","editor","updateSourceElement","sourceElement","tagName","toLowerCase","form","originalSubmit","onSubmit","submit","apply","addEventListener","on","removeEventListener"],"sources":["C:/data/project/realproject/node_modules/@ckeditor/ckeditor5-core/src/editor/utils/attachtoform.js"],"sourcesContent":["/**\n * @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.\n * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license\n */\n\nimport { isFunction } from 'lodash-es';\nimport CKEditorError from '@ckeditor/ckeditor5-utils/src/ckeditorerror';\n\n/**\n * @module core/editor/utils/attachtoform\n */\n\n/**\n * Checks if the editor is initialized on a `<textarea>` element that belongs to a form. If yes, it updates the editor's element\n * content before submitting the form.\n *\n * This helper requires the {@link module:core/editor/utils/elementapimixin~ElementApi ElementApi interface}.\n *\n * @param {module:core/editor/editor~Editor} editor Editor instance.\n */\nexport default function attachToForm( editor ) {\n\tif ( !isFunction( editor.updateSourceElement ) ) {\n\t\t/**\n\t\t * The editor passed to `attachToForm()` must implement the\n\t\t * {@link module:core/editor/utils/elementapimixin~ElementApi} interface.\n\t\t *\n\t\t * @error attachtoform-missing-elementapi-interface\n\t\t */\n\t\tthrow new CKEditorError(\n\t\t\t'attachtoform-missing-elementapi-interface',\n\t\t\teditor\n\t\t);\n\t}\n\n\tconst sourceElement = editor.sourceElement;\n\n\t// Only when replacing a textarea which is inside of a form element.\n\tif ( sourceElement && sourceElement.tagName.toLowerCase() === 'textarea' && sourceElement.form ) {\n\t\tlet originalSubmit;\n\t\tconst form = sourceElement.form;\n\t\tconst onSubmit = () => editor.updateSourceElement();\n\n\t\t// Replace the original form#submit() to call a custom submit function first.\n\t\t// Check if #submit is a function because the form might have an input named \"submit\".\n\t\tif ( isFunction( form.submit ) ) {\n\t\t\toriginalSubmit = form.submit;\n\n\t\t\tform.submit = () => {\n\t\t\t\tonSubmit();\n\t\t\t\toriginalSubmit.apply( form );\n\t\t\t};\n\t\t}\n\n\t\t// Update the replaced textarea with data before each form#submit event.\n\t\tform.addEventListener( 'submit', onSubmit );\n\n\t\t// Remove the submit listener and revert the original submit method on\n\t\t// editor#destroy.\n\t\teditor.on( 'destroy', () => {\n\t\t\tform.removeEventListener( 'submit', onSubmit );\n\n\t\t\tif ( originalSubmit ) {\n\t\t\t\tform.submit = originalSubmit;\n\t\t\t}\n\t\t} );\n\t}\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,SAASA,UAAU,QAAQ,WAAW;AACtC,OAAOC,aAAa,MAAM,6CAA6C;;AAEvE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,SAASC,YAAY,CAAEC,MAAM,EAAG;EAC9C,IAAK,CAACH,UAAU,CAAEG,MAAM,CAACC,mBAAmB,CAAE,EAAG;IAChD;AACF;AACA;AACA;AACA;AACA;IACE,MAAM,IAAIH,aAAa,CACtB,2CAA2C,EAC3CE,MAAM,CACN;EACF;EAEA,MAAME,aAAa,GAAGF,MAAM,CAACE,aAAa;;EAE1C;EACA,IAAKA,aAAa,IAAIA,aAAa,CAACC,OAAO,CAACC,WAAW,EAAE,KAAK,UAAU,IAAIF,aAAa,CAACG,IAAI,EAAG;IAChG,IAAIC,cAAc;IAClB,MAAMD,IAAI,GAAGH,aAAa,CAACG,IAAI;IAC/B,MAAME,QAAQ,GAAG,MAAMP,MAAM,CAACC,mBAAmB,EAAE;;IAEnD;IACA;IACA,IAAKJ,UAAU,CAAEQ,IAAI,CAACG,MAAM,CAAE,EAAG;MAChCF,cAAc,GAAGD,IAAI,CAACG,MAAM;MAE5BH,IAAI,CAACG,MAAM,GAAG,MAAM;QACnBD,QAAQ,EAAE;QACVD,cAAc,CAACG,KAAK,CAAEJ,IAAI,CAAE;MAC7B,CAAC;IACF;;IAEA;IACAA,IAAI,CAACK,gBAAgB,CAAE,QAAQ,EAAEH,QAAQ,CAAE;;IAE3C;IACA;IACAP,MAAM,CAACW,EAAE,CAAE,SAAS,EAAE,MAAM;MAC3BN,IAAI,CAACO,mBAAmB,CAAE,QAAQ,EAAEL,QAAQ,CAAE;MAE9C,IAAKD,cAAc,EAAG;QACrBD,IAAI,CAACG,MAAM,GAAGF,cAAc;MAC7B;IACD,CAAC,CAAE;EACJ;AACD"},"metadata":{},"sourceType":"module"}